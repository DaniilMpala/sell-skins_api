# API Документация

- *apikey*: ****
- *domain*: cobaltskins.tech

в Header: {authorization: Bearer *apikey*} и  {content-type: application/json}

## Описание работы

При данной интеграции на вашем сайте должна быть кнопка, "Депозит" (любая) при нажатие на которую ваш сайт через бекенд отправляет запрос к НАМ с трейд ссылкой или стим айди пользователя и мы возвращаем вам ссылку на депозит, на которую вы перекидываете Юзера, после депозита мы отпраляем вам коллбек об успешной оплате и о том что мы приняли скины с нашей стороны

<img width="3088" height="1686" alt="image" src="https://github.com/user-attachments/assets/750fed07-686c-4d2d-a8be-6fd10e3c07ba" />
<img width="3065" height="1687" alt="image" src="https://github.com/user-attachments/assets/3cd17be7-55c2-408d-b069-52c659316ec2" />



## Основные эндпоинты

### 1. Создание транзакции

**Эндпоинт:** `/api/transaction/pay`

**Метод:** POST

**Пример Body запроса:**

Стим айди или трейд ссылку необходимо передать, чтобы мы понимали, что человек депозитит именно с этого аккаунта а не с левого.  
Необходимо отправлять еще typeTransaction (её мы вам кинули вместе с апикеем), как текстовую константу, чтобы мы понимали что вы хотите сделать.
```json
{
  "typeTransaction": "Const",

  "tradeurl": "https://steamcommunity.com/tradeoffer/new/?partner=****&token=*****",
  "steamID": "7374637372",
}
```

**Тип Body запроса:**

Мы в каллбек отправим meta данные, те же, что вы нам пришлите. Например можете прислать объект с вашим внутренним id, мы его вернем в каллбеке в том же ввиде.
```ts
class CreateTransactionPayDto {
  typeTransaction: string;

  meta?: any
  steamID?: string
  tradeurl?: string;
};
```

**Ответ:**
```json
{
  "urlRedirect": <Будет ссылка куда надо перебросить юзера>
}
```


**После Отмены/Принятия (в том числе в холд)**
  
Мы будем отсылать коллбек до тех пор вам, пока вы не ответите нам ответом 200.

meta - это как раз та самая вашая мета дата, котоыре вы нам отправили при создании транзакции.
```ts
class CallbackDto {
    SteamID: string;
    date: Date;
    cost: number;
    statusTrade: string;
    statusTradeNumber: number;
    offerId: string;
    meta?: any;
    isProtect: boolean;
    isCancel: boolean;
    isAccept: boolean;
    items: {
        assetId: string;
        classid?: string | null;
        instanceid?: string | null;
        hash_name?: string | null;
        float?: number | null;
        paint_index?: number | null;
        paint_seed?: number | null;
        icon_url?: string | null;
        rungame?: string | null;
        color?: string | null;
        stickers?: any | null;
        createdAt: Date;
        appid?: string | null;
        contextid?: string | null;
        priceOnTransaction: number;
    }[];
}
```
